# 0. 인터넷 통신

- 클라이언트 ↔ 인터넷 ↔ 서버
- 인터넷 = 수많은 노드들로 이루어진 망

# 1. IP(인터넷 프로토콜)

- 지정한 IP 주소에 데이터 전달
- `IP 패킷`이라는 통신 단위로 데이터 전달
    - 클라이언트 → 서버
    - 서버 → 클라이언트

ex) 100.100.100.1 → 200.200.200.2 로 request, response 행위를 할 때, 지정된 규약에 의해서 전달된다.

## (1) IP 프로토콜의 한계

- **비연결성**
    - 패킷을 받을 대상이 없거나 서비스 불능 상태여도 패킷을 전송한다.
- **비신뢰성**
    - 중간에 패킷이 사라지면? → 패킷 소실
    - 패킷이 순서대로 안오면? → 패킷 전달 순서 문제
        - 일정 용량 이상의 패킷을 전송할 때, 끊어서 보내게 되는데 순서대로 가지 않는다.
        - 패킷마다 다른 노드를 타다보면 도착 순서가 보장되지 않는다 (보낸 측의 의도와 달라질 수 있다.)
- **프로그램 구분**
    - 같은 IP를 사용하는 서버에서 통신하는 어플리케이션이 둘 이상이면?

## (2) 인터넷 프로토콜 스택의 4계층

- 애플리케이션 계층 - `HTTP`, `FTP`
- 전송 계층 - `TCP`, `UDP`
- 인터넷 계층 - `IP`
- 네트워크 인터페이스 계층

> **전송계층(TCP, UDP)**은 IP 프로토콜의 한계를 보완해주는 역할을 한다.
> 

### (3) 네트워크 순서

1. `Socket 라이브러리`를 이용해 OS 계층에 메시지 전달
2. 메시지(전송 데이터)에다가 `TCP 정보(출발지 PORT, 목적지 PORT, 전송제어, 순서, 검증 정보 ...)`를 씌운다.
3. TCP 데이터를 포함하여 `IP 패킷에 관련된 정보(출발지 IP, 목적지 IP, 기타...)`를 얹는다.
4. `Ethernet frame 정보`를 얹는다. (**MAC 주소** 같은)

> IP 패킷 안에 TCP 정보가 추가로 들어가기 때문에 IP만으로 해결되지 않던 문제를 처리할 수 있게 된다.


# 2. TCP/UDP

## (1) TCP 특징

`전송 제어 프로토콜 (Transmission Control Protocol)`

- **연결 지향** - TCP 3 way handshake (가상 연결)
- **데이터 전달 보증**
- **순서 보장**
- **신뢰할 수 있는 프로토콜**
- **현재는 대부분 TCP 사용**

### TCP 3 way handshake

- 클라이언트도 SYN을 보내고, 서버도 SYN을 보내고 ACK로 SYN을 수락하기 때문에 신뢰성 보장
- 논리적으로 연결된 것일 뿐, 실제로 물리적으로 연결된 것은 아니다. (나를 위한 전용 LAN선이 보장된 것은 아니고 통신 상대끼리 잘 연결이 되겠지라고 믿는 느낌)
- **연결과정** (총 3번의 통신)
    
    1️⃣ `client` → server (SYN : 접속 요청)
    
    2️⃣ client ← `server` (SYN + ACK)
    
    3️⃣ `client` → server (ACK : 요청 수락)
    
    cf. **ACK와 함께 데이터 전송 가능**하다.
    

### 데이터 전달 보증

- 서로 데이터를 받았는지를 응답함으로써 데이터 전달이 제대로 되었는지 확인할 수 있다.
    - **클라이언트 (데이터 전송)** → 서버
    - 클라이언트 ← **(응답 x) 서버**
    - **클라이언트 (응답 재요청)** → 서버

### 순서 보장

- TCP 데이터에 저장된 패킷 순서와 다르게 전달받으면, 다시 보내달라고 요청

ex. TCP 정보: 패킷1,패킷2,패킷3 / 전달받은 순서: 패킷1,패킷3,패킷2 → 패킷2부터 다시 전송 요청

## (2) UDP 특징

`사용자 데이터그램 프로토콜 (User Datagram Protocol)`

- 하얀 도화지에 비유 (기능이 거의 없음)
    - 연결지향 - TCP 3 way handshake X
    - 데이터 전달 보증 X
    - 순서 보장 X
- 데이터 전달 및 순서가 보장되지 않지만, 단순하고 빠름 (TCP는 복잡하고 비교적 느림)
- < **정리** >
    - IP와 거의 같다. + `PORT` + `체크섬` 정도만 추가
    - 더 필요한 기능이 있다면 애플리케이션을 추가해서 사용 가능
    (cf. TCP는 세팅된 상태를 그대로 써야하고, 커스텀하기 어려움)
    - 요즘 HTTP3가 (3way handshack 과정을 줄여보고자) UDP를 쓰면서 굉장히 뜨고 있다.

## (3) PORT - 같은 IP 내에서 프로세스 구분

- IP는 **목적지 서버 구분자,**
PORT는 **목적지 서버의 애플리케이션 구분자**라고 보면 된다.
    
    ex. IP를 아파트, PORT를 동호수
    
- `0 ~ 65535` 할당 가능
- `0 ~ 1023` : 잘 알려진 포트, 사용하지 않는 것이 좋음
    - **FTP** - 20, 21
    - **TELNET** - 23
    - **HTTP** - 80
    - **HTTPS** - 443

## (4) DNS - 도메인 네임 시스템 (Domain Name System)

### 역할 - IP의 문제점 해결

- IP는 기억하기 어렵다 & IP는 변경될 수 있다.
- DNS 서버에 도메인을 만들어 IP주소를 등록해두게 되었다. (like 전화번호부)

### DNS 사용

1. 클라이언트가 DNS 서버에 `도메인 명[google.com](http://google.com)` 을 요청
2. DNS 서버는 도메인 명을 IP주소로 변환하여 클라이언트에 `응답`
3. 클라이언트는 해당 IP를 가진 서버에 `접속`
